
function getSelectionText(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a}function myTextSummary(a,b){b=b||.5,b=0>b?0:1<b?1:b,a=a.replace(/([A-Z]\w{,5})\./g,"$1");let c=a.split(/(?<=\b[0-9a-z)\]]+\.)\s+(?=[A-Z]\w+)|(?<=\w+)\n[A-Z]/g);sents_toknzd=c.map(a=>a.toLowerCase().split(/\W+/g)),sents_tf=sents_toknzd.map(a=>{for(var b in tf={},a.map(a=>tf[a]=tf[a]?tf[a]+1:1),mx=-Infinity,tf)mx=tf[b]>mx?tf[b]:mx;for(b in tf)tf[b]=.5+.5*tf[b]/mx;return tf}),sents_df={};for(var d=0;d<sents_tf.length;d++)for(var e in sents_tf[d])sents_df[e]=sents_df[e]?sents_df[e]+1:1;sents_tfidf=[];for(let c=0;c<sents_tf.length;c++)for(let a in sents_tfidf[c]=0,sents_tf[c])sents_tfidf[c]+=sents_tf[c][a]*Math.log(sents_tf.length/sents_df[a]);mx=Math.max.apply(null,sents_tfidf);let f=c[0]+c[1];for(let d=0;d<c.length;d++)f+=sents_tfidf[d]>b*mx?c[d]+"\n\n":" ";return s=[...sents_tfidf],s.sort((c,a)=>c-a),{strength:b,n:s.length,max:s[s.length-1],min:s[0],median:s.length%2?(s[s.length/2-.5]+s[s.length/2+.5])/2:s[s.length/2],mean:s.reduce((a,b)=>a+b)/s.length,summary:f,s:s}}var pre=document.createElement("textarea");pre.style="z-index:99999; width: 150%; height: 80%; display: block;background-color: #ffffffdd; color: #555533",pre.value="Select text and move the slider";var stats=document.createElement("div");stats.style="z-index:99999; background-color: white; font-size: 10%;";var slider=document.createElement("input");slider.setAttribute("type","range"),slider.setAttribute("min","0"),slider.setAttribute("max","100"),slider.setAttribute("value","50"),slider.addEventListener("change",function(){let a=myTextSummary(getSelectionText(),slider.value/100);pre.value=a.summary,stats.innerHTML="stength: "+a.strength+", # sentences: "+a.n});var container=document.createElement("div");container.style="z-index:99999; width:600px; position: fixed; top: 60px; left: 0;",container.appendChild(slider),container.appendChild(pre),container.appendChild(stats),document.body.appendChild(container);
